{% extends "base.html" %}
{% load url from future %}
{% load i18n %}
{% load hk_generic %}

{% block title %}
{% trans 'Category details' %} - {{ category }} - {{ app_name|title }}
{% endblock %}

{% block content %}

<div id="category_overview">

    <div class="row header">
        <div class="col-tn-12 col-md-8">
            <span {% if category.color %} style="background:#{{ category.color }}" class="
                {% else %}class="label-default {% endif %}label">
            {{ category.name }}</span>
        </div>
        <div class="btn-group col-tn-12">
            <p class="hide-switches">
                <label><input type="checkbox" value="unsubscribed" /> Hide unsubscribed lists</label>
                <label><input type="checkbox" value="subscribed" /> Hide subscribed lists</label>
            </p>
        </div>
    </div> <!-- /row, container for filters and btns -->

    <table class="table list">
        <thead class="hidden-tn hidden-xs">
            <tr>
                <th>list</th>
                <th>discussion</th>
                <th>started by</th>
                <th>comments</th>
                <th>age</th>
            </tr>
        </thead>
        <tbody>
            {% for thread in category_threads %}
            <tr class="thread {% if thread.list.subscribed %}subscribed {% else %}unsubscribed{% endif %}"">
                <td class="col-tn-2">
                    {{ thread.list.name }}
                </td>
                <td class="thread-title col-tn-5">
                    <a class="thread-link" href="#">{{ thread.title }}</a>
                </td>
                <td class="col-tn-2">
                    <span>{{ thread.author }}</span>
                </td>
                <td class="col-tn-2">
                    <i class="icomoon discussion"></i> 
                    <span>{{ thread.answers|length }}</span>
                </td>
                <td class="col-tn-1">
                    <span>{{ thread.age }}</span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table> <!-- /container for list of threads -->

    {% include "paginator.html" with pager=threads %}
</div>
{% endblock %}

{% block additionaljs %}

<script>
    // Filter
    $(".hide-switches input").click(function() {
        var hide_by_class = {};
        $(".hide-switches input").each(function() {
            var cls = $(this).val();
            hide_by_class[cls] = $(this).prop("checked");
        });
        $("table.list tr.thread").each(function() {
            var must_hide = false;
            for (cls in hide_by_class) {
                if ($(this).hasClass(cls) && hide_by_class[cls]) {
                    must_hide = true;
                }
            }
            if (must_hide) {
                $(this).hide();
            } else {
                $(this).show();
            }
        });
    });
    // click behavior for each row
    $("table.list tr.category").click(function(e) {
        document.location.href = $(this).find("a.thread-link").attr("href");
    });
</script>

{% endblock %}